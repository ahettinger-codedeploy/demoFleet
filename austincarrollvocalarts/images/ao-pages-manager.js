(function(){AO.views.PagesManager=Backbone.View.extend({pages:{},initialize:function(){var e=this;this.tpl=parseInt(this.$el.attr("data-t"),10),this.$el.find(".content-section").each(function(){var t=$(this),i=t.attr("id"),s=i.split("_")[1],a="Custom",n=!1,o={el:t};isNaN(parseInt(s))?a=s.charAt(0).toUpperCase()+s.slice(1):(o.pageId=s,o.tpl=this.tpl,s="custom"+s,n=!0),AO.views.pages[a]&&(e.pages[s]=new AO.views.pages[a](o),n&&e.pages[s].loadContent())}),AO.tplId==6&&(e.main_section=$("#main_section"),e.second_section=$("#second_section"),e.sections=$(".content-section"),e.mainMusic=new vMusics,e.mainVideo=$("#video .item-video .ao-video-frame")),e.pages.top=new AO.views.pages.Top({el:$("#carousel_top_bgs")}),AO.core.events.on("page_manager:section:move",$.proxy(this.movePage,this)),AO.core.events.on("page_manager:section:set:font-style",$.proxy(this.setFontStyle,this)),AO.core.events.on("page_manager:get:tempate-id",$.proxy(this.getTemplateId,this)),AO.core.events.on("page_manager:init:custom_styles",$.proxy(this.initCustomStyles,this)),AO.core.events.on("page_manager:set:mode",$.proxy(this.setMode,this)),$(window).load(function(){AO.core.events.trigger("soundcloud:iframe:load"),AO.core.events.trigger("mixcloud:iframe:load"),AO.core.events.trigger("bandcamp:iframe:load")})},setMode:function(e){"preview"==e?this.$el.addClass("ao-preview-mode-page"):this.$el.removeClass("ao-preview-mode-page")},initCustomStyles:function(){var e=this.$el.attr("data-menu-font-size"),t=this.$el.attr("data-menu-font-family"),i=this.$el.attr("data-head-font-size"),s=this.$el.attr("data-head-font-family"),a=this.$el.attr("data-title-font-size"),n=this.$el.attr("data-title-font-family"),o=this.$el.attr("data-text-font-size"),r=this.$el.attr("data-text-font-family");void 0!=e&&AO.core.events.trigger("style_editor:content_styler:set:menu:size",e),void 0!=t&&AO.core.events.trigger("style_editor:content_styler:set:menu:font",t),void 0!=i&&AO.core.events.trigger("style_editor:content_styler:set:head:size",i),void 0!=s&&AO.core.events.trigger("style_editor:content_styler:set:head:font",s),void 0!=a&&AO.core.events.trigger("style_editor:content_styler:set:title:size",a),void 0!=n&&AO.core.events.trigger("style_editor:content_styler:set:title:font",n),void 0!=o&&AO.core.events.trigger("style_editor:content_styler:set:text:size",o),void 0!=r&&AO.core.events.trigger("style_editor:content_styler:set:text:font",r)},getTemplateId:function(){return this.tpl},initPages:function(){},initPage:function(){},setFontStyle:function(e,t){var i=this.$el.attr("data-"+e),s="ao-"+e+"-"+i;this.$el.removeClass(s),this.$el.addClass("ao-"+e+"-"+t),this.$el.attr("data-"+e,t)},addPage:function(e){var t="custom"+e.id;this.pages[t]=new AO.views.pages.Custom({pageId:e.id,tpl:this.tpl,editor:!0,name:e.name,className:AO.tpls[this.tpl-1].className,tagName:AO.tpls[this.tpl-1].tagName});var i=$(".content-section:last"),s=this.pages[t].render().el;this.pages[t].addContentTypeSelector().typeSelector.render(),$(s).insertAfter(i)},showPage:function(e){var t=this,i=e.page,s=!1;if("page"==i&&e.param1=="top"?i="top":"page"!=i||isNaN(parseInt(e.param1))||(i="custom"+e.param1,s=!0),AO.tplId==6&&_.isNull(i)&&(i="top"),this.pages[i]!=void 0)if($("#top_menu").collapse("hide"),AO.tplId==6){"top"==i?(t.second_section.removeClass("active"),t.main_section.addClass("active")):(t.second_section.addClass("active"),t.main_section.removeClass("active"),t.sections.addClass("hidden"),$(t.pages[i].el).removeClass("hidden")),AO.core.pagesManager.pages.musics.myAndroidFix.pause(),t.mainMusic.myAndroidFix.pause(),AO.core.pagesManager.pages.videos.$el.find(".item-video .ao-video-frame").not('[src=""]').each(function(){$(this).attr("src","").hide(),$(this).prev().hide(),$(this).next().show()}),t.mainVideo.attr("src")!=""&&(t.mainVideo.attr("src","").hide(),t.mainVideo.prev().hide(),t.mainVideo.next().show()),$("html, body").scrollTop(0);var a=location.hash;$("#nav .container #top_menu ul.navbar-nav li.active").removeClass("active"),$('#nav .container #top_menu ul.navbar-nav li a[href="'+a+'"]').each(function(){$(this).parent().addClass("active")})}else $("html, body").stop().animate({scrollTop:$(t.pages[i].el).offset().top},1500,"easeInOutExpo")},movePage:function(e,t,i){var s=$("#"+e),a=$("#"+t),n=e.split("_"),o=parseInt(n[1],10);isNaN(o)&&(s=$("#"+e),o=parseInt(s.attr("data-section-id"),10)),isNaN(o)||AO.core.events.trigger("page_manager:section:textarea_off:"+o),1==i?s.insertBefore(a):s.insertAfter(a),isNaN(o)||AO.core.events.trigger("page_manager:section:textarea_on:"+o)},addTopPageBannerImageEditor:function(){}})})();