define(["designer/util/util.instances","designer/util/util.model","jquery","wsbcore/helper"],function(e,t,a,s){function o(e,a){this.$element=e,this.model=new t(a),this.mode=this.model.get("mode"),this.subscriptions=[],this.init()}var i="wsb-social-share";o.prototype={init:function(){var e=this;if("designer"===this.mode&&this.model.isKO){var t=this.model.get();if(t.mutatorViewModel){var a=function(){e.refresh()};for(var s in t.mutatorViewModel)t.ko.isObservable(t.mutatorViewModel[s])&&this.subscriptions.push(t.mutatorViewModel[s].subscribe(a))}}this.refresh(!0)},ready:function(e){var t=this,o=function(){"designer"===t.mode&&t.model.isKO&&require(["/i18n/resources/client","wsbcore/growl"],function(e){a("<div></div>").sfGrowl({title:e.resources.Client__Designer__Yikes_hit_a_snag,content:e.resources.Server__There_has_been_an_unexpected_error,icon:"error"})}),t.destroy()};s.require(["js!//s7.addthis.com/js/300/addthis_widget.js#async=1"],function(){function a(){1>--i&&(clearInterval(s),o())}var s,i=20;s=setInterval(function(){window&&window.addthis&&window.addthis.init?(window.addthis.init(),window.addthis.toolbox(t.$element[0]),"designer"===t.mode&&t.updateOverlay(e)):a()},100)},o)},refresh:function(e){var t=this;this.$element.attr("class",i).children().remove();var s="",o=i+"-button",r=this.model.get("ShareTheme");if("mobile"===this.mode)switch(r){case"Small Buttons":case"Small Buttons - Vertical":case"Buttons - Vertical":r="Buttons";break;case"Counter":case"Counter - Vertical":case"Horizontal Counter":case"Bubble Counter - Vertical":case"Vertical Counter":r="Bubble Counter"}switch(Boolean(r.match(/- Vertical$/i))&&(o+="-vert"),r){case"Buttons":case"Buttons - Vertical":this.$element.addClass("addthis_toolbox addthis_default_style addthis_32x32_style"),this.model.get("ShareFacebook")&&(s+='<a class="addthis_button_facebook '+o+'"></a>'),this.model.get("ShareTwitter")&&(s+='<a class="addthis_button_twitter '+o+'"></a>'),this.model.get("ShareGoogle")&&(s+='<a class="addthis_button_google_plusone_share '+o+'"></a>'),this.model.get("SharePinterest")&&(s+='<a class="addthis_button_pinterest_share '+o+'"></a>'),this.model.get("ShareEmail")&&(s+='<a class="addthis_button_email '+o+'"></a>'),this.model.get("ShareMore")&&(s+='<a class="addthis_button_expanded '+o+'"></a>');break;case"Small Buttons":case"Small Buttons - Vertical":this.$element.addClass("addthis_toolbox addthis_default_style"),this.model.get("ShareFacebook")&&(s+='<a class="addthis_button_facebook '+o+'"></a>'),this.model.get("ShareTwitter")&&(s+='<a class="addthis_button_twitter '+o+'"></a>'),this.model.get("ShareGoogle")&&(s+='<a class="addthis_button_google_plusone_share '+o+'"></a>'),this.model.get("SharePinterest")&&(s+='<a class="addthis_button_pinterest_share '+o+'"></a>'),this.model.get("ShareEmail")&&(s+='<a class="addthis_button_email '+o+'"></a>'),this.model.get("ShareMore")&&(s+='<a class="addthis_button_expanded '+o+'"></a>');break;case"Toolbar":s+='<a class="addthis_button" href="//www.addthis.com/bookmark.php?v=300&amp;pubid=xa-5107daf277cd4d0c"><img src="//s7.addthis.com/static/btn/v2/lg-share-en.gif" width="125" height="16" alt="Bookmark and Share" style="border:0"/></a>';break;default:case"Counter":case"Counter - Vertical":case"Horizontal Counter":this.$element.addClass("addthis_toolbox addthis_default_style"),this.model.get("ShareFacebook")&&(s+='<a class="addthis_button_facebook_like '+o+'" fb:like:layout="button_count"></a>'),this.model.get("ShareTwitter")&&(s+='<a class="addthis_button_tweet '+o+'"></a>'),this.model.get("ShareGoogle")&&(s+='<a class="addthis_button_google_plusone '+o+'" g:plusone:size="medium"></a>');break;case"Bubble Counter":case"Bubble Counter - Vertical":case"Vertical Counter":this.$element.addClass("addthis_toolbox addthis_default_style addthis_counter_style"),this.model.get("ShareFacebook")&&(s+='<a class="addthis_button_facebook_like '+o+'" fb:like:layout="box_count"></a>'),this.model.get("ShareTwitter")&&(s+='<a class="addthis_button_tweet '+o+'" tw:count="vertical"></a>'),this.model.get("ShareGoogle")&&(s+='<a class="addthis_button_google_plusone '+o+'" g:plusone:size="tall"></a>')}this.$element.html(s),"object"!=typeof window.addthis?a(document).ready(function(){t.ready(e)}):t.ready(e)},updateOverlay:function(e){if(!e&&this.model.isKO){var t=this;clearInterval(this.overlayTimer),this.overlayTimerCount=0,this.overlayTimer=setInterval(function(){if(t.overlayTimerCount>=20)clearInterval(t.overlayTimer),t.overlayTimerCount=0;else{t.overlayTimerCount++,t.$element.removeClass("resized");var e=t.model.get("getLast",!0);if(!(e instanceof Function))return;if(!t.model.model||!t.model.model.undoer)return;var a=t.model.model.undoer,s=!a.getCurrentState().isCollect;if(s){var o=t.model.get("getLast",!0)("Width"),i=t.model.get("getLast",!0)("Height");if(parseFloat((o&&o.NewValue||t.model.get("Width")).replace("px",""))<t.$element.outerWidth(!0)){a.disable();var r=t.$element.outerWidth(!0)+"px";o&&(o.NewValue=r),t.model.set("Width",r),a.enable()}if(parseFloat((i&&i.NewValue||t.model.get("Height")).replace("px",""))<t.$element.outerHeight(!0)){a.disable();var l=t.$element.outerHeight(!0)+"px";i&&(i.NewValue=l),t.model.set("Height",l),a.enable()}}else parseFloat(t.model.get("Width").replace("px",""))<t.$element.outerWidth(!0)&&t.model.set("Width",t.$element.outerWidth(!0)+"px"),parseFloat(t.model.get("Height").replace("px",""))<t.$element.outerHeight(!0)&&t.model.set("Height",t.$element.outerHeight(!0)+"px");t.$element.addClass("resized")}},100)}},destroy:function(){for(var e in this.subscriptions)this.subscriptions[e].dispose();r.destroy(this.$element),this.$element.remove()}};var r=new e(i,o);return{render:function(e,t){var a=r.get(e);return a?a.refresh():a=r.create(e,t),a},destroy:function(e){var t=r.get(e);return t?(r.destroy(e),!0):!1}}});
//# sourceMappingURL=social.share.js.map