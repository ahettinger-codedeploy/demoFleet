(function(){LoginCallout={_options:{positionTop:120,rightLoginOffset:100,arrowSrc:{shadow:{right:"/s/img/callout/callout-arrow-right.png",left:"/s/img/callout/callout-arrow-left.png"},noShadow:{right:"/s/img/callout/callout-arrow-right.gif",left:"/s/img/callout/callout-arrow-left.gif"}},getParam:"logincallout=1",loginSelector:{live:"#login",devi:".loggedout"}},init:function(data)
{try
{var loggedoutDisplay=jQuery('.loggedout').css('display');if(this._inCalloutMode(data.websiteCreation,data.loginCallout.period)&&loggedoutDisplay!='none')
{this._arrowSrc=this._options.arrowSrc[/MSIE 6/i.test(navigator.userAgent)?"noShadow":"shadow"];this._arrowSrc.left=data.cdnUrl+this._arrowSrc.left;this._arrowSrc.right=data.cdnUrl+this._arrowSrc.right;this._initDom(data.loginCallout.text);}}catch(ex){throw"Missing jimdo data to initialize LoginCallout: "+ex;}},close:function(){this._calloutJQ.remove();},_inCalloutMode:function(creationTimestamp,period)
{return location.search.indexOf(this._options.getParam)!=-1&&(new Date()).getTime()-(creationTimestamp*1000)<=period*1000;},_initDom:function(textData)
{var htmlArr=[];htmlArr.push("<div class='callout' id='logincallout' style='display: block;'>");htmlArr.push("  <div class='cc-window'>");htmlArr.push("    <div class='cc-window-innerbox'>");htmlArr.push("      <div class='cc-window-buttons-panel-topright'>");htmlArr.push("        <a alt='"+textData.close+"' title='"+textData.close+"' class='cc-button-close' href='#close-all'></a>");htmlArr.push("      </div>");htmlArr.push("      <div class='cc-window-header'>");htmlArr.push("        <div class='cc-window-header-content'>");htmlArr.push("          <h1>");htmlArr.push(textData.title);htmlArr.push("          </h1>");htmlArr.push("        </div>");htmlArr.push("      </div>");htmlArr.push("      <div class='contentFrame'>");htmlArr.push("        <div class='content'>");htmlArr.push(textData.content);htmlArr.push("        </div>");htmlArr.push("      </div>");htmlArr.push("      <div class='footer'/>");htmlArr.push("    </div>");htmlArr.push("  </div>");htmlArr.push("  <img class='arrow'/>");htmlArr.push("</div>");this._calloutJQ=jQuery(htmlArr.join(""));jQuery("body").append(this._calloutJQ);this._boxJQ=this._calloutJQ.find(".cc-window");this._arrowJQ=this._calloutJQ.find(".arrow");jQuery.fn.xPngFix("#logincallout .cc-window-header-content, #logincallout .cc-window, #logincallout .cc-window-buttons-panel-topright a");this._update();this._calloutJQ.find(".cc-button-close").click(this._getOnClickCloseHandler());jQuery(window).bind("scroll",this._getOnScrollHandler()).bind("resize",this._getOnResizeHandler());},_update:function()
{var inHorizontalView=this._isInHorizontalView();this._calloutJQ.css("visibility","hidden");this._updatePosition(inHorizontalView);this._updateArrow(inHorizontalView);this._calloutJQ.css("visibility","visible");},_updatePosition:function(inHorizontalView)
{var loginPosition=this._getLoginPosition();var positionStyle={top:this._options.positionTop+"px"};if(inHorizontalView){positionStyle.left=(loginPosition.left+this._options.rightLoginOffset)+"px";}else{positionStyle.left=(loginPosition.left-this._options.rightLoginOffset-this._boxJQ.outerWidth())+"px";}
this._calloutJQ.css(positionStyle);},_updateArrow:function(inHorizontalView)
{var loginPosition=this._getLoginPosition();var arrowPosition=this._arrowJQ.offset();var boxPosition=this._boxJQ.offset();var arrowStyle={height:loginPosition.top-arrowPosition.top};if(inHorizontalView)
{arrowStyle.width=boxPosition.left+this._boxJQ.outerWidth()-loginPosition.left;arrowStyle.left=(loginPosition.left-boxPosition.left)+"px";this._arrowJQ.css(arrowStyle).attr("src",this._arrowSrc.right);}
else
{var innerImageOffset=25;arrowStyle.width=loginPosition.left-boxPosition.left+innerImageOffset;arrowStyle.left="-"+innerImageOffset+"px";this._arrowJQ.css(arrowStyle).attr("src",this._arrowSrc.left);}},_resetLoginPosition:function(){this._loginPosition=null;},_getLoginPosition:function(reset)
{if(!this._loginPosition){var loginJQ=jQuery(this._options.loginSelector.live);if(loginJQ.length==0){loginJQ=jQuery(this._options.loginSelector.devi);}
var position=loginJQ.offset();var width=loginJQ.width();this._loginPosition={top:position.top,left:(position.left+(width/2))};}
return this._loginPosition;},_isInHorizontalView:function()
{var rightPosition=this._boxJQ.outerWidth()+this._getLoginPosition().left+this._options.rightLoginOffset;return rightPosition<=jQuery(window).width()+jQuery().scrollLeft();},_getOnClickCloseHandler:function()
{var self=this;return function(){self.close();};},_getOnResizeHandler:function()
{var self=this;return function()
{self._resetLoginPosition();self._update();};},_getOnScrollHandler:function()
{var self=this;return function(){self._update();};}};LoginCallout.init(window.jimdoData);})();