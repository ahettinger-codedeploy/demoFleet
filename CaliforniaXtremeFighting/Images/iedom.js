//MenuMachine 2 (v2.0.3) Copyright 2005 Big Bang Software All Rights Reserved
menuPackage.prototype.fIv=function(){var f=this.fo;if(f){try{var url=f.fr.document.location.href}catch(e){f.fr.href=null;return 1}return 0;}else{return 0;}};menuPackage.prototype.cF=function(){if(!this.fo){return 1;}if(__br.mac&&this.fo)return 0;var fo=this.fo;var f=fo.fr,url=null;try{url=f.document.location.href}catch(e){}if(!url)return 0;var e=_gI(pkg.name,f),c=0;if(!e){c=1;var newCode=f.document.body.innerHTML+this.topLevelFrameCode+this.subLevelItemCode+"<\/div>";f.document.body.innerHTML=newCode;e=_gI(pkg.name,f);}var b=this.root,s=e.style;var w=b.dW,h=b.dH,xo=fo.xOffset,yo=fo.yOffset;var iw=parseInt((__br.dt)?fo.fr.document.documentElement.clientWidth:fo.fr.document.body.clientWidth);var ih=parseInt((__br.dt)?fo.fr.document.documentElement.clientHeight:fo.fr.document.body.clientHeight);if(b.oR=="h"){switch(fo.xAlign){case 0:s.left=xo+"px";break;case 1:s.left=(Math.round((iw/2)-(w*8))+xo)+"px";break;case 2:s.left=(iw-(w*16+xo))+"px";break;}s.top=((-h*16)+yo)+"px";}else{switch(fo.yAlign){case 0:s.top=yo+"px";break;case 1:s.top=(Math.round((ih/2)-(h*8))+yo)+"px";break;case 2:s.top=(ih-(h*16+yo))+"px";break;}s.left=((-w*16)+xo)+"px";}if(url==fo.href&&!c){return true;}doOnload(this,f);fo.href=url;return 1;};function doMove(e,fr){e=(e)?e:((event)?event:null);    if(e)    {    if(typeof(e.srcElement)!=_u){var el=e.srcElement;}else{el=e.target;}if(el.nodeType==3){el=el.parentNode;}var itemName=el.getAttribute("m");if(itemName){if(itemName!="b"){var pkg=__menuHolder.getPackage(el.getAttribute("pkg"));if(pkg){if(!pkg.cF())return;var m=pkg.items[pkg.itemIndices[itemName]];if(m){if(__lM && __lM!=m){__hA(__lM,"out");}__lM=m;var b=m.b;if(b.effecting==0 && pkg.isBlockVisible(b)){if(pkg.resetTimer){clearTimeout(pkg.resetTimer);pkg.resetTimer=null;}if(__cM!=m||(__cM==m&&!__oM)){var bc=b.pkg.vB;for(var i=0;i<bc.length;i++){resetItems(bc[i].items)}m.show(0);__hA(m,"over");}__oM=true;}}}}}else if(__oM){var elType=el.getAttribute("m");if(!elType){var doClose=__cM.sub?(!__cM.pkg.isBlockVisible(__cM.sub)?1:0):1;if(__cM && doClose){var bc=__cM.pkg.vB;for(var i=0;i<bc.length;i++){resetItems(bc[i].items)}}var pkg=__cM.pkg,cDy=pkg.cDy-250;if(cDy<0)cDy=0;if(pkg.type==0){pkg.resetTimer=setTimeout("__menuHolder.getPackage('"+pkg.name+"').fullReset()",cDy+200);}__oM=false;__hA(__lM,"out");__lM=false;}}}};function loadHandler(pkgName){var el=_gI(pkgName);if(el!=null&&typeof(el.offsetTop)!=_u){for(var i=0;i<__menuHolder.packages.length;i++){var pkg=__menuHolder.packages[i];if(pkg.name==pkgName){doOnload(pkg);break;}}}else{setTimeout("loadHandler('"+pkgName+"')",10);}};function doOnload(pkg,fr){var strt=new Date();var s=fr?1:0;if(!s&&!pkg.loaded&&!__br.mac)pkg.buildMenuCode(1);var blockList=[];for(var f=0;f<pkg.items.length;f++){var m=pkg.items[f];if((fr&&m.level>0)||(!fr&&((pkg.fo&&m.level==0)||!pkg.fo))){var b=m.b;if(blockList[b.name]!=1){if(fr)b.getDimensions();b._v=new _v(b.name,m,fr);b.z=__gS(b.name+"_z",fr);b.i=__gS(b.name+"_i",fr);blockList[b.name]=1;}if(fr)m.getDimensions();m._v=new _v(m.name,m,fr);m.n=__gS(m.name+"_n",fr);m.o=__gS(m.name+"_o",fr);m.c=__gS(m.name+"_c",fr);if(b.sS){m.sep=new _v(m.name+"_s",m,fr);}}}__cM=m;if(!__menuHolder.lr||fr){__mmAe('onmousemove',doMove,fr); __mmAe('onmousedown',doCk,fr);__mmAe('onmouseup',doUp,fr);__menuHolder.lr=1;}};function _gI(id,fr){var d=(typeof(fr)=="object")?fr.document:document;if(d.getElementById){return d.getElementById(id);}else{return d.all.id;}};__B.prototype.zoom=function(i,doZoom){if(this.pkg.fIv())this.endEffect(i);var effect=this.currentEffect;var dr=effect.dr;if(this.time<dr){this.time++;var pc=effect.ease(this.time,0,1,dr);if(!i)pc=1-pc;var s=this._v.style;s.display="block";s.visibility="inherit";if(doZoom && !__br.og){s.width=em(pc*this.w);s.height=em(pc*this.h);this.z.fontSize=(pc*100)+"%";}if(effect.fade){s.filter="alpha(opacity="+(pc*this.opacity)+")";}}else{this.endEffect(i);}};__B.prototype.fade=function(i){this.zoom(i,0)};__B.prototype.puff=function(i){if(this.pkg.fIv())this.endEffect(i);var effect=this.currentEffect;var cTr=effect.oR;var dr=effect.dr;if(this.time<dr){this.time++;var pc=effect.ease(this.time,0,1,dr);if(!i)pc=1-pc;var s=this._v.style;s.zIndex=9999999;var opc=1-pc;var xd=opc*this.w,yd=opc*this.h;s.left=em(this.x+((cTr?xd:-xd)/2));s.top=em(this.y+((cTr?yd:-yd)/2));var w=this.w+(cTr?-xd:xd);s.width=em(w);var h=this.h+(cTr?-yd:yd);s.height=em(h);var p=(opc*100);this.z.fontSize=(100+(cTr?-p:p))+"%";s.clip="rect(0,"+em(w)+","+em(h)+",0)";s.display="block";s.visibility="inherit";if(effect.fade){s.filter="alpha(opacity="+(pc*this.opacity)+")";}}else{this.endEffect(i);}};__B.prototype.sWs=function(i){if(this.pkg.fIv())this.endEffect(i);var effect=this.currentEffect;var dr=effect.dr;var doVertical=(effect.oR==1||effect.oR==3)?1:0;var doHorizontal=(effect.oR==2||effect.oR==3)?1:0;if(this.time<dr){this.time++;var vd=doVertical?effect.ease(this.time,0,this.dH,dr):0;if(!i)vd=this.dH-vd;var hd=doHorizontal?effect.ease(this.time,0,this.dW,dr):0;if(!i)hd=this.dW-hd;var s=this._v.style;s.clip="rect("+em(doVertical?(this.dH-vd):0)+","+em(this.dW)+","+em(this.dH)+","+em(doHorizontal?(this.dW-hd):0)+")";if(vd)s.top=em((this.y-this.dH)+vd);if(hd)s.left=em((this.x-this.dW)+hd);s.display="block";s.visibility="inherit";if(effect.fade){var pc=easeOut(this.time,0,this.opacity,dr);if(!i)pc=this.opacity-pc;s.filter="alpha(opacity="+pc+")";}}else{this.endEffect(i);}};__B.prototype.startEffect=function(i){if(this.pkg.fIv())this.endEffect(i);if(this.lockOpen)return;if(this.effectTimer){clearInterval(this.effectTimer)};resetItems(this.items);this.time=0;this.effect=i?this.iEF:this.oEF;var s=this._v.style,sS=this.sS;s.top=em(this.y);s.left=em(this.x);s.width=em(this.w);s.height=em(this.eH);if(!this.cIm){this.i.width=em(this.w);this.i.height=em(this.eH);}s.clip="rect(0,"+em(this.dW)+","+em(this.eH)+",0)";this.zIndex=s.zIndex;this.z.fontSize="100%";if(!__br.mac){this._v.el.filters.item(0).enabled=true;}for(var f=0,l=this.items.length;f<l;f++){var m=this.items[f];var ms=m._v.style;ms.width=em(m.dW);ms.height=em(m.dH);ms.left=em(m.x);if(this.pkg.type==0){ms.top=em(m.y);}if(sS){var sep=m.sep.style;sep.width=this.sepWidth;sep.height=this.sepHeight;sep.left=m.sepX;if(this.pkg.type==0){sep.top=m.sepY;}} }this.currentEffect=i?this.iEF:this.oEF;if(this.pkg.type==0 && this.currentEffect.type){this.effecting=(this.currentEffect.type!="fade")?(i?2:1):0;this.effectTimer=setInterval("var q=__menuHolder.getPackage('"+this.pkg.name+"');q.bks[q.bIx['"+this.name+"']]."+this.currentEffect.type+"("+i+",1);",40);}else{this.effectTimer=null;this.endEffect(i);}};__B.prototype.endEffect=function(iOp){clearInterval(this.effectTimer);this.effecting=0;if(this.pkg.fIv()){this.pkg.fullReset();return;}var s=this._v.style;s.zIndex=this.zIndex;if(iOp){s.visibility="inherit";s.display="block";}else{s.visibility="hidden";if(!__br.mac)s.display="none";}if(!iOp){this.parent.highlight(0);}if(!__br.mac&&this.opacity==100){this._v.el.filters.item(0).enabled=false;}};function hideFormElements(h){if(document.getElementsByTagName){var formElements=["textarea","input","select"];for(var f=0;f<3;f++){var formElementArray=document.getElementsByTagName(formElements[f]);for(var i=0;i<formElementArray.length;i++){formElementArray[i].style.visibility=h?"hidden":"visible";}}}else{if(document.forms){var d=document.forms;for(var f=0;f<d.length;f++){var df=d[f],it=df.elements;for(var x=0;x<it.length;x++){it[x].style.visibility=h?"hidden":"visible";}}}}};__B.prototype.calculateOffsets=function(){if(this.pkg.fIv())return;var items=this.items;var exH=0;for(var i=0;i<items.length;i++){var m=items[i],sub=m.sub;if(sub && this.pkg.isBlockVisible(sub)){exH=sub.eH+(2*sub.bW)-(2*this.iPd);break;}}var s=this.sS;for(var f=0;f<items.length;f++){var m=items[f],d=m._v.style;if(s){m.sep.style.visibility=(f==i)?"hidden":"visible";m.sep.style.top=em(((f>=i)?(m.y+exH):m.y)+m.dH+this.iPd);if(f==i)exH-=this.spW;}d.top=em((f>i)?(m.y+exH):m.y);}this.eH=this.h+exH;this._v.style.height=em(this.eH);};var __start=new Date();var debug=true;menuPackage.prototype.buildMenuCode=function(sub){var p=this;var buildStart=new Date();var inheritWH="width:inherit;height:inherit;";var size="overflow:hidden;";var haligns=['left','center','right'],valigns=['top','middle','bottom'];var centerAlign="width:100%;text-align:center";var rightAlign="right:";var leftAlign="left:";var tablestart='<table width="100%" height="100%" cellpadding="0" cellspacing="0"><tr><td align="',png="filter:progid:DXImageTransform.Microsoft.AlphaImageLoader(src=\'";var states=p.states;var eI=(sub||__br.mac)?p.bks.length:1;var code=null;for(var f=(__br.mac?0:sub);f<eI;f++){var b=p.bks[f];var zIndex=(1000*f)+500;b.getDimensions();b.lockOpen=(b.level==0||(b.level <= p.lockLevel && b.parent.isLocked))?1:0;if(b.lockOpen)p.lockedBlocks.push(b);if(f==0){var pos=" style=\""+"display:block;visibility:inherit;width:"+em(b.w)+";height:"+em(b.h)+";left:0px;";p.topLevelFrameCode="<div id=\""+p.name+"\""+pos+_pa+"top:0px;z-index:99999\">";var mac=__br.mac?"<img src=\""+p.mmFolder+"core/spacer.gif\" width=\""+px(b.w)+"\" height='"+em(b.h)+"' style=\"display:block;width:"+em(b.w)+";height:"+em(b.h)+";\" />":"<\/div>";p.topLevelNormalCode="<div id=\""+p.name+"\""+pos+"position:relative;z-index:99999\">"+mac;}if(b.level==0){var w=b.w,h=b.h;var x=b.x,y=b.y;}else{var w=h=x=y=0;}var opaq="filter:alpha(opacity="+b.opacity+",enabled="+(b.level==0?"false":"true")+")";code=(b.level>0&&!__br.mac)?"subLevelItemCode":"topLevelItemCode";p[code].push("<div id=\""+b.name+"\" type=\"b\" m=\"b\" style=\"z-index:"+zIndex+";width:"+em(w)+";height:"+em(h)+";"+size+"top:"+em(y)+";left:"+em(x)+";visibility:"+(b.level==0?"inherit":"hidden")+(__br.mac?"":(";display:"+(b.level==0||p.fo?"b":"none")))+";"+_pa+(b.bkC==""?"":("background-color:"+b.bkC+";"))+"border: "+b.bS+" "+em(b.bW)+" "+b.bCl+";"+opaq+"\"><div id=\""+b.name+"_z\" style=\"font-size:100%;\">");var sS=b.sS?1:0;var l=b.items.length,e=l-1;if(b.bkI!=""){var wh=b.cIm?(em(b.backImgWidth)+";height:"+em(b.backImgHeight)):(em(w)+";height:"+em(h));var img=getLink(p.folderPath,b.bkI);if(__br.v>=5.5&&img.toLowerCase().substr(img.length-3,3)=="png"){p[code].push("<span id=\""+b.name+"_i\" m=\"b\" style=\"width:"+wh+";"+png+img+"\', sizingMethod='scale');\"></span>");}else{p[code].push("<img id=\""+b.name+"_i\" m=\"b\" style=\"width:"+wh+"\" src=\""+getLink(p.folderPath,b.bkI)+"\" />");}}for(var i=0;i<l;i++){var m=b.items[i];m.getDimensions();var n=m.name,im=m.image;if(b.level==0){var w=m.dW,h=m.dH,x=m.x, y=m.y,sepWidth=b.sepWidth,sepHeight=b.sepHeight,sepX=m.sepX,sepY=m.sepY;}else{var w=h=x=y=sepWidth=sepHeight=sepX=sepY=0;}p[code].push("<div id=\""+n+"\" style=\""+_pa+"left:"+em(x)+";top:"+em(y)+";width:"+em(w)+";height:"+em(h)+";"+size+"font-family:"+m.fFm+";\">");var suf=["_n","_o","_c"];for(var z=0;z<3;z++){var s=(m.isLocked&&z==0)?states[p.lockState]:states[z];var border=m["bW"+s]?("border: "+m["bS"+s]+" "+em(m["bW"+s])+" "+m["bCl"+s]):"";var left=z==0?0:em(-m.dW);p[code].push("<div id=\""+n+suf[z]+"\" type=\"menu\" style=\""+_pa+"left:"+left+";top:0;width:"+em(m["w"+s])+";height:"+em(m["h"+s])+";"+border+";"+size+"background-color:"+m["bkC"+s]+";\">");if(m["image"+s]){var img=m["image"+s];if(__br.v>=5.5&&img.toLowerCase().substr(img.length-3,3)=="png"){p[code].push("<img style=\""+_pa+"left:"+m["imageOffset"+s]+";top:"+m["imageOffset"+s]+";width:"+m.iW+";height:"+m.imageHeight+";"+m["imageClip"+s]+size+png+img+"\', sizingMethod='scale');\" src=\""+p.mmFolder+"core/spacer.gif\" />");}else{p[code].push("<img style=\""+_pa+"left:"+m["imageOffset"+s]+";top:"+m["imageOffset"+s]+";width:"+m.iW+";height:"+m.imageHeight+";"+m["imageClip"+s]+size+"\" src=\""+img+"\" />");}}p[code].push('<div style="'+_pa+'top:'+em(m["yP"+s])+';left:'+em(m["textXpos"+s])+';width:'+em(m["textWidth"+s])+';height:'+em(m["h"+s])+';overflow:hidden;color:'+m["fnC"+s]+';'+fSts[m["fSt"+s]]+';text-decoration:'+m["txD"+s]+';text-align:'+haligns[m["txA"+s]]+';"><span style="font-size:'+em(m["fSz"+s])+' !important;">'+m["text"+s]+'</span></div>');if(m["icI"+s]){p[code].push("<img style=\""+_pa+"left:"+em(m["icXo"+s])+";top:"+em(m["icYo"+s])+";width:"+em(m.icW)+";height:"+em(m.icH)+";\" src=\""+getLink(p.folderPath,m["icI"+s])+"\" />");}if(m.sub && b["ar"+s]!=""){p[code].push("<img style=\""+_pa+"left:"+em(m["arXoffset"+s])+";top:"+em(m["arYoffset"+s])+";width:"+em(b.arWidth)+";height:"+em(b.arHeight)+";\" src=\""+b["ar"+s]+"\" />");}p[code].push("<\/div>");}p[code].push("<div style='"+_pa+"top:0;left:0;width:100%;height:100%;'><img m=\""+n+"\" pkg=\""+p.name+"\" style=\""+(m.url!=""?"cursor:pointer;":"")+"\" src=\""+p.mmFolder+"core/spacer.gif"+"\" "+(m.ttT!=""?("title=\""+m.ttT+"\""):"")+" width='100%' height='100%' /></div>");p[code].push("</div>");if(sS){var d=(i==e)?"display:none;":"";p[code].push("<div id=\""+n+"_s\" m=\"b\" style=\"background-color:"+b.spC+";"+_pa+d+"top:"+sepY+";left:"+sepX+";width:"+sepWidth+";height:"+sepHeight+";\"><img m=\"b\" style=\"width:100%;height:100%;\" src=\""+p.mmFolder+"core/spacer.gif"+"\"/></div>");}}p[code].push("<\/div>");p[code].push("<\/div>");}if(code){p[code]=p[code].join("\n");}if(sub&&!__br.mac){if(!p.fo&&code){var el=_gI(p.name);var cnt=el.innerHTML;if(__br.mac){el.innerHTML="";}el.innerHTML=cnt+p[code];}}else{if(__br.mac){document.write(p.topLevelNormalCode+p[code]+"</div>");}else{document.write(p.topLevelNormalCode);var el=_gI(p.name);el.innerHTML=p[code];var par=el.parentNode;if(par){var zmax=9999;while(par.nodeName!="BODY"){if(par.nodeName=="DIV"){var s=par.style;if(s.position=="relative"){if(parseInt(s.zIndex)==0){s.zIndex=zmax;}else{zmax=s.zIndex;}}}par=par.parentNode;}}}}};pkg.buildMenuCode(0);function __mmAe(type,func,fr){var d=(typeof(fr)=="object")?fr.document:document;if(typeof(d.attachEvent)!=_u){d.attachEvent(type,func); }else{d[type]=func; }};window.onunload=function(){var h=__menuHolder.packages;for(var i=0;i<h.length;h++){var it=h[i].items;for(var f=0;f<it.length;f++){var m=it[f];if(m.b){var bb=m.b;bb.i=bb.z=bb._v=null;m.b=null;}m.n=m.o=m.c=m.v=m.sub=m.sep=null;}}};loadHandler(pkg.name);
