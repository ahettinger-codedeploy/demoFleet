(function(b){var a={scaleType:"fill",positionX:"",positionY:"",offsetX:0,offsetY:0,container:b(window),src:"",backgroundColor:"#000",cssPosition:"absolute",maxWidth:10,maxHeight:10,marginAdj:0};b.fn.wstBackground=function(){a.src=this.attr("src");c(this);j(this);h(this);this.each(function(){var k=b(".sf_outer_wrapper").css("margin-top");if(k.indexOf("-")==-1&&k.indexOf("px")!=-1){b(this).css("margin-top","-"+k);var l=k.replace("px","");if(!isNaN(l)){a.marginAdj=parseInt(l)}}if(b.browser.msie==true&&b.browser.version<=6){b(this).css("position","absolute")}if(b(this).is("img")){e(b(this))}});function e(k){var l=function(m){var p;if(a.scaleType=="fill"){p=i(m.width,m.height)}else{if(a.scaleType=="fit"){p=d(m.width,m.height)}else{p=f(m.width,m.height)}}var s=(a.scaleType=="fit"&&p.bestDimension=="width")?"center":a.positionX;var o=(a.scaleType=="fit"&&p.bestDimension=="height")?"middle":a.positionY;var r=(s=="right"?(p.width.container-p.width.best):s=="center"?(Math.ceil((p.width.container-p.width.best)/2)):0)+a.offsetX;var q=(o=="bottom"?(p.height.container-p.height.best):o=="middle"?(Math.ceil((p.height.container-p.height.best)/2)):0)+a.offsetY;if(k){var n={left:r+"px",top:q+"px"};if(a.scaleType!="normal"){n[p.bestDimension]=p[p.bestDimension].best+"px";n[p.offDimension]=""}k.css(n)}};g(a.src,l)}function c(k){if(k.hasClass("bg-fill")){a.scaleType="fill"}else{if(k.hasClass("bg-fit")){a.scaleType="fit"}else{if(k.hasClass("bg-normal")){a.scaleType="normal"}}}}function j(k){if(k.hasClass("x-left")){a.positionX="left"}else{if(k.hasClass("x-center")){a.positionX="center"}else{if(k.hasClass("x-right")){a.positionX="right"}}}}function h(k){if(k.hasClass("y-top")){a.positionY="top"}else{if(k.hasClass("y-middle")){a.positionY="middle"}else{if(k.hasClass("y-bottom")){a.positionY="bottom"}}}}function g(n,l){var k=function(q,o,r,p){if(o.height==0){if(p>=30){if(window.console&&console.log){console.log("Giving up... unable to get image dimensions for "+q)}}else{setTimeout(function(){k(q,o,r,++p)},100)}}else{r({height:o.height,width:o.width,src:q})}};var m=new Image();m.src=n;k(n,m,l,0)}function f(l,k){var m={width:{image:l,container:a.container.width()==0?a.maxWidth:a.container.width(),best:l},height:{image:k,container:a.container.height()==0?a.maxHeight:a.container.height()+a.marginAdj,best:k}};return m}function i(m,l){var n={width:{image:m,container:a.container.width()==0?a.maxWidth:a.container.width()},height:{image:l,container:a.container.height()==0?a.maxHeight:a.container.height()+a.marginAdj}};n.width.ifOppositeFillsContainer=Math.ceil((n.width.image*n.height.container)/n.height.image);n.height.ifOppositeFillsContainer=Math.ceil((n.height.image*n.width.container)/n.width.image);n.width.ifOppositeFillsIsUsed=Math.ceil((n.width.image*n.height.ifOppositeFillsContainer)/n.height.image);n.height.ifOppositeFillsIsUsed=Math.ceil((n.height.image*n.width.ifOppositeFillsContainer)/n.width.image);n.width.minimumToFillContainer=!(n.width.container<=n.width.ifOppositeFillsContainer)?n.width.container:n.width.ifOppositeFillsContainer;n.height.minimumToFillContainer=!(n.height.container<=n.height.ifOppositeFillsContainer)?n.height.container:n.height.ifOppositeFillsContainer;var k=(n.height.ifOppositeFillsIsUsed>n.height.container)?"width":"height";var o=(k=="width")?"height":"width";n.bestDimension=k;n.offDimension=o;n.text=k+": "+n[k].minimumToFillContainer+"px;";n[k].best=n[k].minimumToFillContainer;n[o].best=(Math.ceil((n[o].image*n[k].minimumToFillContainer)/n[k].image));return n}function d(m,l){var n={width:{image:m,container:a.container.width()==0?a.maxWidth:a.container.width()},height:{image:l,container:a.container.height()==0?a.maxHeight:a.container.height()+a.marginAdj}};var k=(m<l)?"height":"width";var o=(k=="width")?"height":"width";n.bestDimension=k;n.offDimension=o;n.text=k+": "+n[k].container+"px;";n[k].best=n[k].container;n[o].best=Math.ceil((n[o].image*n[k].container)/n[k].image);return n}};b(document).ready(function(){b("#ss-background").wstBackground()});b(window).resize(function(){b("#ss-background").wstBackground()})})(jQuery);